<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Document</title>
  </head>
  <body>
    <style>
      * {
        margin: 0;
      }
      body {
        display: flex;
        align-items: center;
        justify-content: center;
        height: 100vh;
        width: 100vw;
      }
      #canvas {
        border: 2px dotted gray;
      }
    </style>
    <canvas id="canvas" height="600" width="600"></canvas>
    <script>
      const canvas = document.getElementById("canvas");
      const ctx = canvas.getContext("2d");
      const image = document.createElement("img");
      // image.src = "./test.jpeg";
      // image.crossOrigin = "Anonymous";
      // image.onload = () => {
      //   ctx.drawImage(image, 0, 0, 200, 200);
      //   const imageData = ctx.getImageData(0, 0, 200, 200);
      //   // 反转效果
      //   const imageData1 = new ImageData(imageData.width, imageData.height);
      //   const data1 = new Uint8ClampedArray(imageData.data);
      //   for (let i = 0; i < data1.length; i += 4) {
      //     data1[i] = 255 - data1[i];
      //     data1[i + 1] = 255 - data1[i + 1];
      //     data1[i + 2] = 255 - data1[i + 2];
      //   }
      //   imageData1.data.set(data1);
      //   ctx.putImageData(imageData1, 0, 200);
      //   // 黑白效果
      //   const imageData2 = new ImageData(imageData.width, imageData.height);
      //   const data2 = new Uint8ClampedArray(imageData.data);
      //   for (let i = 0; i < data2.length; i += 4) {
      //     // const average = (data2[i] + data2[i + 1] + data2[i + 2]) / 3; // 普通平均值
      //     const average =
      //       (data2[i] * 0.3 + data2[i + 1] * 0.6 + data2[i + 2] * 0.1) / 3; // 加权平均值
      //     data2[i] = average;
      //     data2[i + 1] = average;
      //     data2[i + 2] = average;
      //   }
      //   imageData2.data.set(data2);
      //   ctx.putImageData(imageData2, 200, 200);
      //   // 亮度效果
      //   const imageData3 = new ImageData(imageData.width, imageData.height);
      //   const data3 = new Uint8ClampedArray(imageData.data);
      //   for (let i = 0; i < data3.length; i += 4) {
      //     const a = 50;
      //     data3[i] += a;
      //     data3[i + 1] += a;
      //     data3[i + 2] += a;
      //   }
      //   imageData3.data.set(data3);
      //   ctx.putImageData(imageData3, 400, 200);
      //   // 复古效果
      //   const imageData4 = new ImageData(imageData.width, imageData.height);
      //   const data4 = new Uint8ClampedArray(imageData.data);
      //   for (let i = 0; i < data4.length; i += 4) {
      //     const r = data4[i];
      //     const g = data4[i + 1];
      //     const b = data4[i + 2];
      //     data4[i] = r * 0.39 + g * 0.76 + b * 0.18;
      //     data4[i + 1] = r * 0.35 + g * 0.68 + b * 0.16;
      //     data4[i + 2] = r * 0.27 + g * 0.53 + b * 0.13;
      //   }
      //   imageData4.data.set(data4);
      //   ctx.putImageData(imageData4, 0, 400);
      //   // 红色蒙版
      //   const imageData5 = new ImageData(imageData.width, imageData.height);
      //   const data5 = new Uint8ClampedArray(imageData.data);
      //   for (let i = 0; i < data5.length; i += 4) {
      //     const average = (data5[i] + data5[i + 1] + data5[i + 2]) / 3;
      //     data5[i] = average;
      //     data5[i + 1] = 0;
      //     data5[i + 2] = 0;
      //   }
      //   imageData5.data.set(data5);
      //   ctx.putImageData(imageData5, 200, 400);
      //   // 透明处理
      //   const imageData6 = new ImageData(imageData.width, imageData.height);
      //   const data6 = new Uint8ClampedArray(imageData.data);
      //   for (let i = 0; i < data6.length; i += 4) {
      //     data6[i + 3] *= 0.3;
      //   }
      //   imageData6.data.set(data6);
      //   ctx.putImageData(imageData6, 400, 400);
      // };

      const imageData = ctx.createImageData(100, 100);
      for (let i = 0; i < 100 * 100 * 4; i += 4) {
        const data = imageData.data;
        data[i] = 0;
        data[i + 1] = 0;
        data[i + 2] = 255;
        data[i + 3] = 255;
      }
      ctx.putImageData(imageData, 20, 20);
    </script>
  </body>
</html>
